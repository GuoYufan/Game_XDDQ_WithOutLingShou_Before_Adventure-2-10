import random, math, traceback
from Stat import Stat
from Fight import Fight, FightEnd



class Role():
    def __init__(self,åŸºç¡€å±æ€§åˆ—è¡¨,åç§°):
        # --- åŸº ç¡€ å± æ€§ ---
        self.è¡€,self.æ”»,self.é˜²,self.æ•=åŸºç¡€å±æ€§åˆ—è¡¨
        self._å‰©ä½™è¡€é‡=self.è¡€
        self.å·²æ‰è¡€é‡=self.è¡€-self._å‰©ä½™è¡€é‡
        self.å‰©ä½™è¡€é‡ç™¾åˆ†æ¯”=0
        self.å·²æ‰è¡€é‡ç™¾åˆ†æ¯”=0
        self.åç§°=åç§°
        self.å¯¹æ‰‹=None
        
        # --- å®£ å¸ƒ æœ¬ åœº æˆ˜ æ–— ç»“ æŸ ---
        self.å·²æ­»äº¡=False
        
        # --- å¦– æ°” ä¸ ç¥ é€š ---
        self._ç°é˜¶æ®µ="ç­‘åŸº"
        self.ç¥é€šåŠŸèƒ½å¼€å¯=False
        self.å¦–æ°”=0
        self.æºå¸¦ç¥é€š=[]
        self._æ—¶åˆ»=str()
        self.å·²å®Œæˆè¡¥æ°”=False
        
        # --- å¤ æ´» ç›¸ å…³ ---
        self.å¤æ´»æœªèµ·èº«=False
        self.å¯å¤æ´»æ¬¡æ•°=0
        
        # --- æˆ˜ æ–— å± æ€§ ç›¸ å…³ ---
        self.å¸=self.è¿=self.æš´=0
        self.æŠ—å¸=self.æŠ—è¿=self.æŠ—æš´=0
        self._è§¦å‘äº†è¿å‡»=self._è§¦å‘äº†æš´å‡»=False
        self.æš´ä¼¤ç³»æ•°=2
        self.é’é¾™çµè„‰=0
        self.æ¯æ¬¡æš´å‡»åæš´ä¼¤ç³»æ•°é€’å¢=(7+5*self.é’é¾™çµè„‰)/100 if self.é’é¾™çµè„‰ else 0
    
    
        # --- åª’ ä½“ æ´» åŠ¨ ä¸ è®° è€… ---
        self.è®°è€…=Stat()
        self.è®°è€….é€‰æ‰‹=self
        
        # --- æˆ˜ åœº ---
        self.æˆ˜åœº=None
       
        # --- æ¨¡ ç³Š æˆ˜ æŠ¥ ä¹‹ é¢ æ¿ è®¡ ç®—---
        self.é¢æ¿_æœ‰è§†é˜²å¾¡ä¼¤=0
        self.é¢æ¿_æ‰“å¯¹æ–¹å›åˆæ•°=0
        self.é¢æ¿_æ‰“å¯¹æ–¹å®é™…å›åˆæ•°=0
        self.é¢æ¿_æœ‰è§†é˜²å¾¡ä¼¤ç™¾åˆ†æ¯”=0
        self.é¢æ¿_å¸è¡€å›è¡€é‡=0
        self.å“ªä¸€æ–¹=""
        self.é¢æ¿_ä¸»çµå…½ä¼¤ç™¾åˆ†æ¯”=0
        self.é¢æ¿_ä¸»çµå…½æ²»ç–—ç™¾åˆ†æ¯”=0
        
        # --- çŠ¶ æ€ ---
        self.éœ€è¦å¤±å»å‡ æ¬¡è¡ŒåŠ¨=0
        
        # --- çµ å…½ ---
        self.ä¸»çµå…½åç§°=""
        self.ä¸»çµå…½ä¼¤å€ç‡_ä¹˜åœ¨æ”»=0
        self.ä¸»çµå…½å‡ºæ‰‹é¢‘ç‡=0
        self.buff_æ”»=Buff("æ”»",self,0,0)
        self.buff_è¿=Buff("è¿",self,0,0)
        self.ä¸»çµå…½æ²»ç–—å€ç‡_ä¹˜åœ¨æ”»=0
        
        # --- å¢ å‡ ä¼¤ ---
        self.buff_å‡ä¼¤=Buff("å‡ä¼¤",self,0,0)
        self.å¢ä¼¤=0
        self.å‡ä¼¤=0
        
        self.buff_ON=True
        
        self.è¿å‡»ç‡æ¸å‡ç³»æ•°=0.8
        
    
    def ä¸ºäº†ä¸“ç”¨äºæ–°å·è€Œå¼€å§‹(self):
        if self.ç°é˜¶æ®µ in ("ç­‘åŸº"):
            self.ç¥é€šåŠŸèƒ½å¼€å¯=False

    @property
    def ç°é˜¶æ®µ(self):
        return self._ç°é˜¶æ®µ
        
    @ç°é˜¶æ®µ.setter    
    def ç°é˜¶æ®µ(self,value):
         self._ç°é˜¶æ®µ=value
         self.ä¸ºäº†ä¸“ç”¨äºæ–°å·è€Œå¼€å§‹()
    
    @property
    def è§¦å‘äº†æš´å‡»(self):
        return self._è§¦å‘äº†æš´å‡»
        
    @è§¦å‘äº†æš´å‡».setter    
    def è§¦å‘äº†æš´å‡»(self,value):
         self._è§¦å‘äº†æš´å‡»=value
         if self._è§¦å‘äº†æš´å‡»:
             self.è®°è€….æœ¬åœºè§¦å‘æš´å‡»+=1
             self.è®°è€….ç´¯è®¡è§¦å‘æš´å‡»+=1
             
    @property
    def è§¦å‘äº†è¿å‡»(self):
        return self._è§¦å‘äº†è¿å‡»
        
    @è§¦å‘äº†è¿å‡».setter    
    def è§¦å‘äº†è¿å‡»(self,value):
         self._è§¦å‘äº†è¿å‡»=value
         if self._è§¦å‘äº†è¿å‡»:
             self.è®°è€….æœ¬åœºè§¦å‘è¿å‡»+=1
             self.è®°è€….ç´¯è®¡è§¦å‘è¿å‡»+=1                  
    
    @property
    def å‰©ä½™è¡€é‡(self):
        return self._å‰©ä½™è¡€é‡
    
    @å‰©ä½™è¡€é‡.setter
    def å‰©ä½™è¡€é‡(self,value):
        if value>self.è¡€:value=self.è¡€
        self._å‰©ä½™è¡€é‡=value
        self.å·²æ‰è¡€é‡=self.è¡€-self._å‰©ä½™è¡€é‡
        self.å‰©ä½™è¡€é‡ç™¾åˆ†æ¯”=self.å‰©ä½™è¡€é‡/self.è¡€*100
        self.å·²æ‰è¡€é‡ç™¾åˆ†æ¯”=self.å·²æ‰è¡€é‡/self.è¡€*100        
        if self.å·²æ‰è¡€é‡ç™¾åˆ†æ¯” > self.å¯¹æ‰‹.è®°è€….å†å²å°†æ•Œäººå‹åˆ°æœ€ä½è¡€çº¿["æ•°å€¼"]:
            self.å¯¹æ‰‹.è®°è€….å†å²å°†æ•Œäººå‹åˆ°æœ€ä½è¡€çº¿["é‚£ä¸€åœºé™„å¸¦ä¿¡æ¯"]=\
f"(é‚£ä¸€åœºï¼šè¿å‡»{self.å¯¹æ‰‹.è®°è€….æœ¬åœºè§¦å‘è¿å‡»}æ¬¡ï¼Œæš´å‡»{self.å¯¹æ‰‹.è®°è€….æœ¬åœºè§¦å‘æš´å‡»}æ¬¡ï¼Œå‡ºç°åœ¨ç¬¬{self.æˆ˜åœº.ç¬¬å‡ åœº}åœº)"
            if self.å·²æ‰è¡€é‡ç™¾åˆ†æ¯”>=100 and self.å¯¹æ‰‹.è®°è€….å†å²å°†æ•Œäººå‹åˆ°æœ€ä½è¡€çº¿["æ•°å€¼"]<100:
                self.å¯¹æ‰‹.è®°è€….ç¬¬ä¸€æ¬¡ä½¿æ•Œäººæ‰ä¸€ç®¡è¡€="(ç¬¬ä¸€æ¬¡æ‰“æ‰æ•Œäºº100%ä»¥ä¸Šè¡€æ˜¯åœ¨"+self.å¯¹æ‰‹.è®°è€….å†å²å°†æ•Œäººå‹åˆ°æœ€ä½è¡€çº¿["é‚£ä¸€åœºé™„å¸¦ä¿¡æ¯"][1:-1]+")"
            self.å¯¹æ‰‹.è®°è€….å†å²å°†æ•Œäººå‹åˆ°æœ€ä½è¡€çº¿["æ•°å€¼"]=self.å·²æ‰è¡€é‡ç™¾åˆ†æ¯”
            
            
        self.å·²æ­»äº¡=self.å‰©ä½™è¡€é‡<=0
        if self.å·²æ­»äº¡:self.æ£€æŸ¥å¤æ´»()
        
    @property
    def æ—¶åˆ»(self):return self._æ—¶åˆ»
    
    @æ—¶åˆ».setter
    def æ—¶åˆ»(self,value):
        self._æ—¶åˆ»=value
        if self._æ—¶åˆ» in ("æ‰è¡€ä¹‹æœªå›å¦–æ°”","æ™®æ”»åä¹‹æœªå›å¦–æ°”","å—åˆ°èš€é­‚å’’"):
            if self.ç¥é€šåŠŸèƒ½å¼€å¯:self.å¦–æ°”å˜åŒ–()
        elif self._æ—¶åˆ»=="æ™®æ”»åä¹‹æœªå‘åŠ¨ç¥é€š":
            if self.ç¥é€šåŠŸèƒ½å¼€å¯:self.ç¥é€šè·Ÿéš()
        elif self._æ—¶åˆ»=="å›åˆç»“æŸæ—¶":
            if self.buff_ON:self.buffå˜åŒ–()
            
    def å¦–æ°”å˜åŒ–(self):
        if self.æ—¶åˆ»=="é‡Šæ”¾é“æ³•å":
            self.å¦–æ°”=0
            self.å·²å®Œæˆè¡¥æ°”=False
            if "ä¸ƒåäºŒå˜" in self.æºå¸¦ç¥é€š:
                self.å¦–æ°”+=3000
            return
        if self.æ—¶åˆ»=="æ‰è¡€ä¹‹æœªå›å¦–æ°”":
            self.å¦–æ°”+=self.æœ¬æ¬¡å—ä¼¤é‡/self.è¡€*5000
        elif self.æ—¶åˆ»=="æ™®æ”»åä¹‹æœªå›å¦–æ°”":
            self.å¦–æ°”+=2000
        elif self.æ—¶åˆ»=="å—åˆ°èš€é­‚å’’":
            self.å¦–æ°”-=800
            
        if self.å¦–æ°”>=10000:
            self.å¦–æ°”=10000
            self.å·²å®Œæˆè¡¥æ°”=True
        elif self.å¦–æ°”<0:
            self.å¦–æ°”=0
    
    def ç¥é€šè·Ÿéš(self):
        if self.æ—¶åˆ»=="æ™®æ”»åä¹‹æœªå‘åŠ¨ç¥é€š":
            if "èš€é­‚å’’" in self.æºå¸¦ç¥é€š:
                print(f"â—ï¸{self.åç§°}çš„ç¥è¯†ç¥é€šèš€é­‚å’’å‘åŠ¨,{self.å¯¹æ‰‹.åç§°}æ­¤å‰å¦–æ°”{self.å¯¹æ‰‹.å¦–æ°”:g},",end="")
                self.å¯¹æ‰‹.æ—¶åˆ»="å—åˆ°èš€é­‚å’’"
                print(f"ç›®å‰å¦–æ°”{self.å¯¹æ‰‹.å¦–æ°”:g}")
    
    def è®¡ç®—æœ¬æ¬¡ä¼¤å®³å‡ºå‘(self,ä¼¤å®³ç§ç±»):
        if ä¼¤å®³ç§ç±»=="æœ‰è§†é˜²å¾¡ä¼¤":
            self.æœ¬æ¬¡ä¼¤å®³å‡ºå‘=(self.æ”»-self.å¯¹æ‰‹.é˜²)*(1+self.å¢ä¼¤-self.å¯¹æ‰‹.å‡ä¼¤)
            if self.è§¦å‘äº†æš´å‡»:
                self.æœ¬æ¬¡ä¼¤å®³å‡ºå‘=(self.æ”»-self.å¯¹æ‰‹.é˜²)*self.æš´ä¼¤ç³»æ•°*(1+self.å¢ä¼¤-self.å¯¹æ‰‹.å‡ä¼¤)
                self.æš´ä¼¤ç³»æ•°+=self.æ¯æ¬¡æš´å‡»åæš´ä¼¤ç³»æ•°é€’å¢                
                self.è§¦å‘äº†æš´å‡»=False
            return
        if ä¼¤å®³ç§ç±»=="ä¸»çµå…½ä¼¤":
            self.æœ¬æ¬¡ä¼¤å®³å‡ºå‘=self.æ”»*self.ä¸»çµå…½ä¼¤å€ç‡_ä¹˜åœ¨æ”»*(1+self.å¢ä¼¤-self.å¯¹æ‰‹.å‡ä¼¤)
            return
                
    def è®¡ç®—æœ¬æ¬¡ä¼¤å®³å—åˆ°(self):
        self.æœ¬æ¬¡ä¼¤å®³å—åˆ°=self.å¯¹æ‰‹.æœ¬æ¬¡ä¼¤å®³å‡ºå‘
        if not self.æˆ˜åœº.å…³é—­æˆ˜æŠ¥:print(f"{self.åç§°}å—åˆ°ä¼¤å®³:{int(self.æœ¬æ¬¡ä¼¤å®³å—åˆ°)} æ‰è¡€ç™¾åˆ†æ¯”:{self.æœ¬æ¬¡ä¼¤å®³å—åˆ°/self.è¡€*100:.2f}%")
    
    def æ£€æŸ¥å¤æ´»(self):
        self.å·²æ­»äº¡=self.å‰©ä½™è¡€é‡<=0
        å·¦=self.æˆ˜åœº.å·¦
        
        if self.å·²æ­»äº¡:
            if not self.æˆ˜åœº.å…³é—­æˆ˜æŠ¥:print("ï¼ˆç›®å‰å‰©ä½™è¡€é‡ï¼š%s%g(%.2f%%) VS %s%g(%.2f%%)ï¼‰"%(\
                 å·¦.åç§°, å·¦.å‰©ä½™è¡€é‡, å·¦.å·²æ‰è¡€é‡ç™¾åˆ†æ¯”,
                 å·¦.å¯¹æ‰‹.åç§°, å·¦.å¯¹æ‰‹.å‰©ä½™è¡€é‡, å·¦.å¯¹æ‰‹.å·²æ‰è¡€é‡ç™¾åˆ†æ¯”))
            if å·¦.ç¥é€šåŠŸèƒ½å¼€å¯ and not self.æˆ˜åœºå…³é—­æˆ˜æŠ¥:
                print("ï¼ˆç›®å‰å¦–æ°”ï¼š%s%g VS %s%gï¼‰"%(\
                    å·¦.åç§°,å·¦.å¦–æ°”,\
                    å·¦.å¯¹æ‰‹.åç§°,å·¦.å¯¹æ‰‹.å¦–æ°”))
            if not (self.å¤æ´»æœªèµ·èº« or self.å¯å¤æ´»æ¬¡æ•°>0):
                if not self.æˆ˜åœº.å…³é—­æˆ˜æŠ¥:
                    print(f"ï¼ˆ{self.åç§°}å·²æ­»ï¼Œæ— å¤æ´»ï¼‰")
                    print(f"\nğŸ“–\nï¼ˆ{self.åç§°}å‘Šè´Ÿï¼‰")
                self.æˆ˜åœº.è°èƒœ=self.å¯¹æ‰‹
                raise FightEnd()
            if not self.æˆ˜åœº.å…³é—­æˆ˜æŠ¥:print(f"ï¼ˆ{self.åç§°}å·²æ­»ï¼Œæœ‰å¤æ´»ï¼‰")
            self.å¤æ´»æœªèµ·èº«=True
    
    def æ‰è¡€ä¹‹è¡€æ¡å˜åŒ–(self):
        self.å‰©ä½™è¡€é‡-=self.æœ¬æ¬¡ä¼¤å®³å—åˆ°
    
    def è¿å‡»æš´å‡»åˆ¤å®š(self):
        if 1 <= random.randint(1,100) <= (self.è¿-self.å¯¹æ‰‹.æŠ—è¿)*self.è¿å‡»ç‡æ¸å‡ç³»æ•°:
            self.è§¦å‘äº†è¿å‡»=True
            self.è¿å‡»ç‡æ¸å‡ç³»æ•°*=0.8
            if not self.æˆ˜åœº.å…³é—­æˆ˜æŠ¥:print(f"â—ï¸{self.åç§°}è§¦å‘äº†è¿å‡»")
        else:
            self.è§¦å‘äº†è¿å‡»=False
            self.è¿å‡»ç‡æ¸å‡ç³»æ•°=1
        
        if 1 <= random.randint(1,100) <= self.æš´-self.å¯¹æ‰‹.æŠ—æš´:
            self.è§¦å‘äº†æš´å‡»=True
            if not self.æˆ˜åœº.å…³é—­æˆ˜æŠ¥:print(f"â—ï¸{self.åç§°}è§¦å‘äº†æš´å‡»")
        else:self.è§¦å‘äº†æš´å‡»=False
   
    def é‡Šæ”¾é“æ³•(self):
        print("â—ï¸é‡Šæ”¾é“æ³•")
        self.æ—¶åˆ»="é‡Šæ”¾é“æ³•å"
        
        
    def è¿›è¡Œæ™®æ”»(self):
        self.æ—¶åˆ»="æ™®æ”»åä¹‹æœªå›å¦–æ°”"
        while True:
            self.è¿å‡»æš´å‡»åˆ¤å®š()
            self.è®¡ç®—æœ¬æ¬¡ä¼¤å®³å‡ºå‘("æœ‰è§†é˜²å¾¡ä¼¤")
            self.å¯¹æ‰‹.è®¡ç®—æœ¬æ¬¡ä¼¤å®³å—åˆ°()
            '''
            if self.æˆ˜åœº.ç¬¬å‡ å›åˆ==3:
                print(self.æ”»)
                print(self.æœ¬æ¬¡ä¼¤å®³å‡ºå‘)
                print(self.å¯¹æ‰‹.æœ¬æ¬¡ä¼¤å®³å—åˆ°)
                input()
                '''
            self.è¿›è¡Œå¸è¡€()
            self.å¯¹æ‰‹.æ—¶åˆ»=="æ‰è¡€ä¹‹æœªå›å¦–æ°”"
            self.æ—¶åˆ»="æ™®æ”»åä¹‹æœªå‘åŠ¨ç¥é€š"
            self.å¯¹æ‰‹.æ‰è¡€ä¹‹è¡€æ¡å˜åŒ–()   
            if self.è§¦å‘äº†è¿å‡»:                
                self.è§¦å‘äº†è¿å‡»=False
                continue
            break

    def æ¯æ¬¡è½®åºæ•°æ®é‡ç½®(self):
        self.æœ¬æ¬¡å›è¡€=self.å¯¹æ‰‹.æœ¬æ¬¡å›è¡€=self.æœ¬æ¬¡ä¼¤å®³=self.å¯¹æ‰‹.æœ¬æ¬¡ä¼¤å®³=0
        
    def è½®åºåˆ°äººç‰©(self):
        if not self.æˆ˜åœº.å…³é—­æˆ˜æŠ¥:print(f"ã€{self.åç§°}è¡ŒåŠ¨ã€‘")
        if self.å¤æ´»æœªèµ·èº«:
            self.å¯å¤æ´»æ¬¡æ•°-=1
            self.å¤æ´»æœªèµ·èº«=False
            self.å‰©ä½™è¡€é‡=self.è¡€*0.12
        if not self.å¯¹æ‰‹.å¤æ´»æœªèµ·èº«:
            if self.å·²å®Œæˆè¡¥æ°”:self.é‡Šæ”¾é“æ³•()
            else:self.è¿›è¡Œæ™®æ”»()
            
    def è®¡ç®—å•æ–¹é¢æ¿(self):
        self.é¢æ¿_æœ‰è§†é˜²å¾¡ä¼¤=self.æ”»-self.å¯¹æ‰‹.é˜²
        self.é¢æ¿_æ‰“å¯¹æ–¹å›åˆæ•°=self.å¯¹æ‰‹.è¡€/self.é¢æ¿_æœ‰è§†é˜²å¾¡ä¼¤
        self.é¢æ¿_æ‰“å¯¹æ–¹å®é™…å›åˆæ•°=math.ceil(self.é¢æ¿_æ‰“å¯¹æ–¹å›åˆæ•°)
        self.é¢æ¿_æœ‰è§†é˜²å¾¡ä¼¤ç™¾åˆ†æ¯”=1/self.é¢æ¿_æ‰“å¯¹æ–¹å›åˆæ•°
        self.é¢æ¿_å¸è¡€å›è¡€é‡=0 if self.å¸-self.å¯¹æ‰‹.æŠ—å¸<=0 else int(self.é¢æ¿_æœ‰è§†é˜²å¾¡ä¼¤*(self.å¸-self.å¯¹æ‰‹.æŠ—å¸)/100)
        self.é¢æ¿_ä¸»çµå…½ä¼¤ç™¾åˆ†æ¯”=self.æ”»*self.ä¸»çµå…½ä¼¤å€ç‡_ä¹˜åœ¨æ”»/self.å¯¹æ‰‹.è¡€
        self.é¢æ¿_ä¸»çµå…½æ²»ç–—ç™¾åˆ†æ¯”=self.æ”»*self.ä¸»çµå…½æ²»ç–—å€ç‡_ä¹˜åœ¨æ”»/self.è¡€
             
    def è¿›è¡Œå¸è¡€(self):
        self.å¸è¡€å›è¡€é‡=int(self.å¯¹æ‰‹.æœ¬æ¬¡ä¼¤å®³å—åˆ°*(self.å¸-self.å¯¹æ‰‹.æŠ—å¸)/100) if self.å¸>self.å¯¹æ‰‹.æŠ—å¸ else 0
        if not self.æˆ˜åœº.å…³é—­æˆ˜æŠ¥:print(f"{self.åç§°}å¸è¡€å›è¡€é‡:{self.å¸è¡€å›è¡€é‡} æ²»ç–—ç™¾åˆ†æ¯”:{self.å¸è¡€å›è¡€é‡/self.è¡€*100:.2f}%")
        self.å‰©ä½™è¡€é‡+=self.å¸è¡€å›è¡€é‡
        
    def è®¾ç½®æˆ˜æ–—å±æ€§(self, å‡å±, é«˜å±å="", é«˜å±=-1):
        self.å¸=self.è¿=self.æš´=å‡å±
        if é«˜å±å:exec(f"self.{é«˜å±å}={é«˜å±}")
    
    def è®¾ç½®æˆ˜æ–—æŠ—æ€§(self, å‡æŠ—, é«˜æŠ—å="", é«˜æŠ—=-1):
        self.æŠ—å¸=self.æŠ—è¿=self.æŠ—æš´=å‡æŠ—
        if é«˜æŠ—å:exec(f"self.{é«˜æŠ—å}={é«˜æŠ—}")
    
    def ä½¿åŒæ–¹æˆ˜æ–—å±æ€§ä¸æŠ—æ€§å®Œå…¨ç›¸ç­‰(self):
        pass
            
    def è®°è€…çš„å˜åŒ–(self):
        if self.æˆ˜åœº.è°èƒœ==self.è®°è€….é€‰æ‰‹:
            self.è®°è€….è·èƒœæ¬¡æ•°+=1
        self.è®°è€….å‚èµ›æ¬¡æ•°+=1
    

    def buffå˜åŒ–(self):
        if self.æ—¶åˆ»=="å›åˆç»“æŸæ—¶":
            #print("å›åˆç»“æŸæ—¶decrement",self.buff_æ”».role.æ”», self.buff_æ”».__dict__)
            #input()
            self.buff_æ”».decrement()
            #print("å›åˆç»“æŸæ—¶decrement",self.buff_æ”».role.æ”», self.buff_æ”».__dict__)
            #input()
            self.buff_è¿.decrement()
            self.buff_å‡ä¼¤.decrement()                 
                
        if self.buff_æ”».is_deactivated():
            if not self.æˆ˜åœº.å…³é—­æˆ˜æŠ¥:print(f"(çµå…½æ•ˆæœå·²ç»“æŸ:æ­¤å‰æ”»å‡»åŠ›{self.æ”»:g},",end="")
            #print("ä»æ¿€æ´»åˆ°å¤±æ•ˆ",self.buff_æ”».role.æ”», self.buff_æ”».__dict__)
            #input()
            self.buff_æ”».deactivate()  
            #print("ä»æ¿€æ´»åˆ°å¤±æ•ˆ",self.buff_æ”».role.æ”», self.buff_æ”».__dict__)
            #input() 
            if not self.æˆ˜åœº.å…³é—­æˆ˜æŠ¥:print(f"ç°æ”»å‡»åŠ›{self.æ”»:g})\n")
        
        if self.buff_è¿.is_deactivated():
            if not self.æˆ˜åœº.å…³é—­æˆ˜æŠ¥:print(f"(çµå…½æ•ˆæœå·²ç»“æŸ:æ­¤å‰è¿å‡»ç‡{self.è¿-self.å¯¹æ‰‹.æŠ—è¿:g}%,",end="")
            self.buff_è¿.deactivate()
            if not self.æˆ˜åœº.å…³é—­æˆ˜æŠ¥:print(f"ç°è¿å‡»ç‡{self.è¿-self.å¯¹æ‰‹.æŠ—è¿:g}%)\n")
        
        if self.buff_å‡ä¼¤.is_deactivated():
            if not self.æˆ˜åœº.å…³é—­æˆ˜æŠ¥:print(f"(çµå…½æ•ˆæœå·²ç»“æŸ:æ­¤å‰å‡ä¼¤{self.å‡ä¼¤*100:g}%,",end="")
            self.buff_å‡ä¼¤.deactivate()
            if not self.æˆ˜åœº.å…³é—­æˆ˜æŠ¥:print(f"ç°å‡ä¼¤{self.å‡ä¼¤*100:g}%)\n")
            
    
    def çµå…½æ•ˆæœ(self):
        if not self.buff_ON:return
        
        if self.ä¸»çµå…½åç§°=="çµç‹":
            if not self.æˆ˜åœº.å…³é—­æˆ˜æŠ¥:print(f"(çµå…½æ•ˆæœ:æ­¤å‰æ”»å‡»åŠ›{self.æ”»:g},",end="")
            # å¦‚æœåœ¨æ•ˆæœæœªç»“æŸæ—¶å†æ¬¡ç»™æ•ˆæœï¼Œä¸å åŠ ã€‚ç›´åˆ°ä¸Šæ¬¡æ•ˆæœç»“æŸæ‰é‡æ–°ç›¸åŒæ•ˆæœã€‚
            # å†æ€ä¹ˆæ ·ä¹Ÿåªæ˜¯æ•ˆæœä¸æ–­ï¼Œè€Œä»æ¥ä¸ä¼šæ˜¯æ›´å¼ºçš„æ•ˆæœã€‚
            # å¦åˆ™åŠ å¼ºæ•ˆæœï¼Œè¿ä¹˜å¤šæ¬¡ï¼Œå¤ªå˜æ€äº†ã€‚            
            if self.buff_æ”».active==False:
                #print("ä»å¤±æ•ˆåˆ°æ¿€æ´»",self.buff_æ”».role.æ”», self.buff_æ”».__dict__)
                #input()
                self.buff_æ”».activate("æ”»",1.2,1)
                #print("ä»å¤±æ•ˆåˆ°æ¿€æ´»",self.buff_æ”».role.æ”», self.buff_æ”».__dict__)
                #input()
            if not self.æˆ˜åœº.å…³é—­æˆ˜æŠ¥:print(f"ç°æ”»å‡»åŠ›{self.æ”»:g})")
        
        elif self.ä¸»çµå…½åç§°=="å¤©é©¬":
            if not self.æˆ˜åœº.å…³é—­æˆ˜æŠ¥:print(f"(çµå…½æ•ˆæœ:æ­¤å‰è¿å‡»ç‡{self.è¿-self.å¯¹æ‰‹.æŠ—è¿:g}%,",end="")
            # å¦‚æœåœ¨æ•ˆæœæœªç»“æŸæ—¶å†æ¬¡ç»™æ•ˆæœï¼Œä¸å åŠ ã€‚ç›´åˆ°ä¸Šæ¬¡æ•ˆæœç»“æŸæ‰é‡æ–°ç›¸åŒæ•ˆæœã€‚
            # å†æ€ä¹ˆæ ·ä¹Ÿåªæ˜¯æ•ˆæœä¸æ–­ï¼Œè€Œä»æ¥ä¸ä¼šæ˜¯æ›´å¼ºçš„æ•ˆæœã€‚
            # å¦åˆ™åŠ å¼ºæ•ˆæœï¼Œè¿ä¹˜å¤šæ¬¡ï¼Œå¤ªå˜æ€äº†ã€‚
            if self.buff_è¿.active==False:
                self.buff_è¿.activate("è¿",1.2,1)
            
            if not self.æˆ˜åœº.å…³é—­æˆ˜æŠ¥:print(f"ç°è¿å‡»ç‡{self.è¿-self.å¯¹æ‰‹.æŠ—è¿:g}%)")   	
        
        elif self.ä¸»çµå…½åç§°=="é¸¾é¸Ÿ":
            if not self.æˆ˜åœº.å…³é—­æˆ˜æŠ¥:print(f"(çµå…½æ•ˆæœ:æ­¤å‰å‡ä¼¤{self.å‡ä¼¤*100:g}%,",end="")
            
            if self.buff_å‡ä¼¤.active==False:
                self.buff_å‡ä¼¤.activate("å‡ä¼¤",0.15,1)
            
            if not self.æˆ˜åœº.å…³é—­æˆ˜æŠ¥:print(f"ç°å‡ä¼¤{self.å‡ä¼¤*100:g}%)")   	
            
 
        
    def è½®åºåˆ°çµå…½(self):
        if not self.ä¸»çµå…½åç§°:return
        
        if not self.æˆ˜åœº.ç¬¬å‡ å›åˆ%self.ä¸»çµå…½å‡ºæ‰‹é¢‘ç‡==0:return
                
        if self.ä¸»çµå…½ä¼¤å€ç‡_ä¹˜åœ¨æ”»:
            if not self.æˆ˜åœº.å…³é—­æˆ˜æŠ¥:print(f"ã€{self.åç§°}{self.å“ªä¸€æ–¹}ä¸»çµå…½{self.ä¸»çµå…½åç§°}è¡ŒåŠ¨ã€‘")            
            # å…ˆé€ æˆä¼¤å®³å†æ•ˆæœ
            self.è®¡ç®—æœ¬æ¬¡ä¼¤å®³å‡ºå‘("ä¸»çµå…½ä¼¤")
            self.å¯¹æ‰‹.è®¡ç®—æœ¬æ¬¡ä¼¤å®³å—åˆ°()        
            self.å¯¹æ‰‹.æ‰è¡€ä¹‹è¡€æ¡å˜åŒ–()
            self.çµå…½æ•ˆæœ()
        
        if self.ä¸»çµå…½æ²»ç–—å€ç‡_ä¹˜åœ¨æ”»:
            if not self.æˆ˜åœº.å…³é—­æˆ˜æŠ¥:print(f"ã€{self.åç§°}{self.å“ªä¸€æ–¹}ä¸»çµå…½{self.ä¸»çµå…½åç§°}è¡ŒåŠ¨ã€‘")            
            # å…ˆé€ æˆä¼¤å®³å†æ•ˆæœ
            self.è®¡ç®—æœ¬æ¬¡æ²»ç–—("ä¸»çµå…½æ²»ç–—")
            self.å—åˆ°æ²»ç–—()        
            self.çµå…½æ•ˆæœ()
   
    def å—åˆ°æ²»ç–—(self):
       self.å‰©ä½™è¡€é‡+=self.æœ¬æ¬¡æ²»ç–—
       if not self.æˆ˜åœº.å…³é—­æˆ˜æŠ¥:print(f"{self.åç§°}å—åˆ°æ²»ç–—:{int(self.æœ¬æ¬¡æ²»ç–—)} æ²»ç–—ç™¾åˆ†æ¯”:{self.æœ¬æ¬¡æ²»ç–—/self.è¡€*100:.2f}%")
             
    def è®¡ç®—æœ¬æ¬¡æ²»ç–—(self,æ²»ç–—ç§ç±»):
        if æ²»ç–—ç§ç±»=="ä¸»çµå…½æ²»ç–—":
            self.æœ¬æ¬¡æ²»ç–—=self.æ”»*self.ä¸»çµå…½æ²»ç–—å€ç‡_ä¹˜åœ¨æ”»
            return
            
        
class Buff():
    def __init__(self, name, role, multiplier, duration):
        # ç´¯è®¡è§¦å‘äº†å‡ æ¬¡
        self.time=0
        # åç§°ï¼šæ”» æˆ– è¿
        self.name = name
        # è§’è‰²ï¼šä»å±äºå“ªä¸ªè§’è‰²
        self.role = role
        # å¢ç›Šæ•ˆæœ
        self.multiplier = multiplier
        # æŒç»­å›åˆæ•°
        self.duration = duration
        # æ˜¯å¦æ¿€æ´»
        self.active = False
        
    # ç”Ÿæ•ˆ / åº”ç”¨æ•ˆæœ
    def apply(self):
        if not self.active:
            if self.name=="æ”»":
                self.role.æ”» *= self.multiplier
                self.role.æ”» = int(self.role.æ”»)
            elif self.name=="è¿":
                self.role.è¿ *= self.multiplier
            elif self.name=="å‡ä¼¤":
            	self.role.å‡ä¼¤ += self.multiplier
            self.active = True

    # åˆ·æ–°æŒç»­å›åˆæ•°
    def refresh(self,d):
        self.duration = d
        
    # å‰©ä½™å›åˆæ•°å‡å°‘
    def decrement(self):
        if self.active:
            self.duration -= 1
            if self.duration <= 0: pass
    
    # è§¦å‘æ•ˆæœ          
    def activate(self, n, m, d):
        self.time+=1
        self.name = n
        self.multiplier = m        
        self.apply()
        self.refresh(d)
        self.active = True
    
    # æ˜¯å¦ä»æ¿€æ´»åˆ°å¤±æ•ˆ         
    def is_deactivated(self):
        return self.time>0 and self.active==True and self.duration==0
    
    
    # å½“ä»æ¿€æ´»åˆ°å¤±æ•ˆæ—¶
    def deactivate(self):
        if self.name=="æ”»":
            self.role.æ”»/=self.multiplier
            self.role.æ”»=int(self.role.æ”»)
        elif self.name=="è¿":
            self.role.è¿/=self.multiplier
        elif self.name=="å‡ä¼¤":
        	self.role.å‡ä¼¤-=self.multiplier
        self.active=False
            